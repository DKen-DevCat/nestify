# Nestify â€” Claude Code ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜æ›¸

## 1. ãƒ¡ã‚¿æƒ…å ± & ãƒ­ãƒ¼ãƒ«å®šç¾©

- **è¨€èª**: å¸¸ã«æ—¥æœ¬èªã§å¿œç­”ã™ã‚‹ã“ã¨ã€‚
- **ãƒ­ãƒ¼ãƒ«**: Nestify å°‚ä»»ã® **ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ + èª¿æŸ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**ã€‚
- **ç›®çš„**:
  - Nestify ã®å®Ÿè£…ãƒ»æ”¹ä¿®ãƒ»èª¿æŸ»ã‚¿ã‚¹ã‚¯ã‚’å®‰å…¨ã‹ã¤ä¸€è²«ã—ãŸå“è³ªã§é‚è¡Œã™ã‚‹ã€‚
  - å†—é•·ãªé‡è¤‡ã‚’é¿ã‘ã¤ã¤ã€è¡Œå‹•ã«å¿…è¦ãªãƒ«ãƒ¼ãƒ«ãƒ»å‚ç…§å…ˆã‚’ã“ã“ã§æ˜ç¤ºã™ã‚‹ã€‚
- **å‰æ**:
  - äººé–“ã®é–‹ç™ºè€…ã‚‚ç¢ºèªç”¨ã«èª­ã‚€ãŒã€**ä¸»ãªèª­è€…ã¯ Claude Code** ã¨ã™ã‚‹ã€‚
  - è©³ç´°ãªå®Ÿè£…æƒ…å ±ï¼ˆDB ã‚¹ã‚­ãƒ¼ãƒã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãªã©ï¼‰ã¯ã€å¿…è¦ã«å¿œã˜ã¦åˆ¥ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã™ã‚‹ã€‚

---

## 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**Nestify** ã¯ã€Spotify ã®æ¥½æ›²ã‚’å¯¾è±¡ã¨ã—ãŸã€Œãƒã‚¹ãƒˆå‹ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ã‚¢ãƒ—ãƒªã€ã§ã‚ã‚‹ã€‚
Spotify ãŒæä¾›ã™ã‚‹ãƒ•ãƒ©ãƒƒãƒˆãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ§‹é€ ã«å¯¾ã—ã¦ã€PC ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚ˆã†ã« **å†å¸°çš„ã«ç„¡é™ãƒã‚¹ãƒˆ** ã§ãã‚‹ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ä½“é¨“ã‚’æä¾›ã™ã‚‹ã€‚

### 2.1 ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

- ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®ä¸­ã«ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹ï¼ˆç„¡é™å†å¸°ï¼‰ã€‚
- è¦ªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å†ç”Ÿã™ã‚‹ã¨ã€å­å­«ã®ã™ã¹ã¦ã®æ›²ã‚’å«ã‚ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«å†ç”Ÿã§ãã‚‹ã€‚
- è¦ªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ã€Œç›´æ¥è¿½åŠ ã®æ›²ã®ã¿ã€ã§å†ç”Ÿã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚
- éŸ³æºå†ç”Ÿã¯ Spotify ã«å®Œå…¨ã«å§”ã­ã‚‹ã€‚ã‚¢ãƒ—ãƒªã¯ã‚ãã¾ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ã«ç‰¹åŒ–ã™ã‚‹ã€‚
- Spotify ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã—ã€æ—¢å­˜ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¨ Spotify ã¸ã®æ›¸ãå‡ºã—ã«å¯¾å¿œã™ã‚‹ã€‚

### 2.2 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆè¦ç´„ï¼‰

- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**:
  - Next.js 15 (App Router) / React 19 / TypeScript
  - Tailwind CSS v4
  - Zustandï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ï¼‰+ TanStack Query v5ï¼ˆã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ï¼‰
  - @dnd-kitï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**:
  - Bun + Hono + TypeScript
  - Drizzle ORM + PostgreSQLï¼ˆSupabaseï¼‰
  - Hono RPC ã«ã‚ˆã‚‹å‹å®‰å…¨ãª API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- **ãã®ä»–**:
  - ãƒ†ã‚¹ãƒˆ: bun testï¼ˆBE ãƒ¦ãƒ‹ãƒƒãƒˆï¼‰+ Playwrightï¼ˆE2Eï¼‰
  - ãƒ¢ãƒãƒ¬ãƒ: Bun Workspaces + Turborepo
  - ãƒ‡ãƒ—ãƒ­ã‚¤å€™è£œ: Vercelï¼ˆFEï¼‰/ Railway or Fly.ioï¼ˆBEï¼‰

ã‚ˆã‚Šè©³ç´°ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãƒ»DB ã‚¹ã‚­ãƒ¼ãƒã¯ `nestify/ARCHITECTURE.md` ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã€‚

---

## 3. å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä¸€è¦§

Claude Code ã¯ã€ä»¥ä¸‹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å¿…è¦ã«å¿œã˜ã¦å‚ç…§ã™ã‚‹ã€‚

- `[nestify/ARCHITECTURE.md](nestify/ARCHITECTURE.md)`  
  Nestify ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãƒ»é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºãªã©ã€‚
- `nestify-ui.html`  
  UI ãƒ¢ãƒƒã‚¯ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³å‚è€ƒã€‚
- `[research-improvement-strategies.md](research-improvement-strategies.md)`  
  èª¿æŸ»ç²¾åº¦ãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå“è³ªã®æ¨ªæ–­çš„ã‚¬ã‚¤ãƒ‰ã€‚

ï¼ˆå°†æ¥çš„ã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ã‚„è©³ç´°ãƒ«ãƒ¼ãƒ«ã‚’åˆ†é›¢ã™ã‚‹å ´åˆã¯ã€`nestify/DEV-RULES.md` ã‚’è¿½åŠ ã—ã€ã“ã“ã‹ã‚‰ãƒªãƒ³ã‚¯ã™ã‚‹ã€‚ï¼‰

---

## 4. Nestify å°‚ç”¨é–‹ç™ºãƒ«ãƒ¼ãƒ«ï¼ˆã‚µãƒãƒªï¼‰

ã“ã“ã§ã¯ Claude Code ã®æŒ¯ã‚‹èˆã„ã«ç›´æ¥å½±éŸ¿ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã®ã¿ã‚’è¦ç´„ã™ã‚‹ã€‚
è©³ç´°ãªå®Ÿè£…ä¾‹ã‚„èƒŒæ™¯ãŒå¿…è¦ãªå ´åˆã¯ã€ã‚³ãƒ¼ãƒ‰ã¨ `nestify/ARCHITECTURE.md` ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã€‚

### 4.1 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: Railway Oriented Programming (ROP)

- APIãƒ»ã‚µãƒ¼ãƒ“ã‚¹å±¤ã§ã¯ **Railway Oriented Programming** ã«å¾“ã†ã€‚
- æˆåŠŸ/å¤±æ•—ã‚’ `Result` å‹ï¼ˆã¾ãŸã¯ `{ ok: true; data } | { ok: false; error }`ï¼‰ã®ã‚ˆã†ãªåˆ¤åˆ¥å¯èƒ½ãªå½¢ã§è¡¨ç¾ã™ã‚‹ã€‚
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å¤±æ•—ã¯æˆ»ã‚Šå€¤ã§è¿”ã—ã€ä¾‹å¤–ã¯äºˆæœŸã—ãªã„è‡´å‘½çš„ãªå ´åˆã«é™ã‚‹ã€‚

### 4.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: é–¢æ•°å‹ã‚ˆã‚Šã®è¨­è¨ˆ

- çŠ¶æ…‹å¤‰æ›´ã¯æ¥µåŠ›é¿ã‘ã€**ç´”ç²‹é–¢æ•°ãƒ»ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªæ›´æ–°**ã‚’å„ªå…ˆã™ã‚‹ã€‚
- å‰¯ä½œç”¨ï¼ˆAPI å‘¼ã³å‡ºã—ã€localStorageã€DOM æ“ä½œï¼‰ã¯ hooks ã‚„å°‚ç”¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«é›†ç´„ã™ã‚‹ã€‚
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å¯èƒ½ãªé™ã‚Š **å‚ç…§é€é**ï¼ˆåŒã˜ props â†’ åŒã˜è¦‹ãŸç›®ï¼‰ã«ãªã‚‹ã‚ˆã†æ„è­˜ã™ã‚‹ã€‚

### 4.3 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„ï¼ˆè¦ç´„ï¼‰

- **Server Component First**:
  - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ Server Componentã€‚
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ãŒå¿…è¦ãªå ´åˆã®ã¿ `"use client"` ã‚’ä»˜ä¸ã—ã€ã‚¹ã‚³ãƒ¼ãƒ—ã¯æœ€å°é™ã«ã™ã‚‹ã€‚
- **const-only**:
  - åŸå‰‡ã¨ã—ã¦ `let` / `var` ã¯ä½¿ã‚ãš `const` ã®ã¿ã€‚
  - å†ä»£å…¥ãŒæ¬²ã—ããªã£ãŸã‚‰ã€`map` / `filter` / `reduce` ãªã©ã®é–¢æ•°å‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’æ¤œè¨ã™ã‚‹ã€‚
- **TDDï¼ˆt-wada ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰**:
  - Red â†’ Green â†’ Refactor ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’å®ˆã‚‹ã€‚
  - ä»•æ§˜ã¯ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‹ã‚‰èª­ã‚ã‚‹ã‚ˆã†ã«æ›¸ãã€‚
- **SRP / DRY**:
  - 1 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ»1 é–¢æ•° = 1 è²¬å‹™ã€‚
  - é‡è¤‡ã‚³ãƒ¼ãƒ‰ã‚’è¨±å®¹ã—ãªã„ã€‚ãŸã ã—æ„å›³çš„ãªé‡è¤‡ã‚’æ®‹ã™å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ç†ç”±ã‚’æ˜ç¤ºã™ã‚‹ã€‚
- **TypeScript**:
  - `any` ç¦æ­¢ï¼ˆå¿…è¦ãªã‚‰ `unknown` + å‹ã‚¬ãƒ¼ãƒ‰ï¼‰ã€‚
  - é–¢æ•°ã®å¼•æ•°ã¨æˆ»ã‚Šå€¤ã®å‹ã¯åŸºæœ¬çš„ã«æ˜ç¤ºã™ã‚‹ã€‚
  - `strict: true` ã‚’ç¶­æŒã™ã‚‹ã€‚
- **å‘½åè¦å‰‡ï¼ˆç°¡ç•¥ç‰ˆï¼‰**:

  | å¯¾è±¡                  | è¦å‰‡             | ä¾‹                          |
  | --------------------- | ---------------- | --------------------------- |
  | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ        | PascalCase       | `PlaylistCard`              |
  | é–¢æ•°ãƒ»å¤‰æ•°            | camelCase        | `fetchPlaylists`            |
  | å®šæ•°                  | UPPER_SNAKE_CASE | `MAX_RETRY_COUNT`           |
  | å‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹  | PascalCase       | `Playlist`, `PlaylistProps` |
  | ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆComponentï¼‰ | PascalCase.tsx   | `Header.tsx`                |
  | ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãã®ä»–ï¼‰    | camelCase.ts     | `utils.ts`                  |

### 4.4 UI æ–¹é‡ï¼ˆè¦ç´„ï¼‰

- **shadcn/ui + Tailwind CSS v4** ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã™ã‚‹ã€‚
- ã‚¢ã‚¤ã‚³ãƒ³ã¯ **lucide-react** ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒå›ºå®šã€‚
- ãƒ•ã‚©ãƒ³ãƒˆ: Syneï¼ˆè¦‹å‡ºã—ï¼‰+ Space Monoï¼ˆæ•°å€¤ãƒ»ã‚³ãƒ¼ãƒ‰ï¼‰ã€‚
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼: `#7c6af7`ï¼ˆãƒ‘ãƒ¼ãƒ—ãƒ«ï¼‰/ `#f76a8a`ï¼ˆãƒ”ãƒ³ã‚¯ï¼‰/ `#6af7c8`ï¼ˆã‚°ãƒªãƒ¼ãƒ³ï¼‰ã€‚
- å†ç”Ÿä¸­ã®æ›²ã¯ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã€å­å­«ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç”±æ¥ã®æ›²ã«ã¯ `ç¶™æ‰¿ Â· {ã‚½ãƒ¼ã‚¹PLå}` ãƒãƒƒã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

è©³ç´°ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé…ç½®ã‚„ãƒ¢ãƒƒã‚¯ã¯ `nestify-ui.html` ã¨ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã™ã‚‹ã“ã¨ã€‚

---

## 5. å“è³ªç®¡ç†

### 5.1 å“è³ªç›®æ¨™

- **æ­£ç¢ºæ€§**: ä»•æ§˜ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«æ•´åˆã™ã‚‹å®Ÿè£…ã§ã‚ã‚‹ã“ã¨ã€‚
- **å®‰å…¨æ€§**: å‹ã‚¨ãƒ©ãƒ¼ãƒ»lint ã‚¨ãƒ©ãƒ¼ãƒ»æ˜ã‚‰ã‹ãªãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã‚’æ®‹ã•ãªã„ã“ã¨ã€‚
- **ãƒ†ã‚¹ãƒˆå¯èƒ½æ€§**: å¤‰æ›´ãŒãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„æ§‹é€ ï¼ˆSRPãƒ»ç´”ç²‹é–¢æ•°ï¼‰ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã€‚
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´åˆæ€§**: é‡è¦ãªå¤‰æ›´ã«å¯¾ã—ã¦ã€é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€‚

### 5.2 å¤‰æ›´æ™‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆClaude ç”¨ï¼‰

ã‚³ãƒ¼ãƒ‰å¤‰æ›´ã‚„è¨­è¨ˆå¤‰æ›´ã‚’è¡Œã†éš›ã¯ã€æ¬¡ã®é …ç›®ã‚’æ„è­˜ã—ã¦é€²ã‚ã‚‹ã“ã¨ã€‚

- **Before å®Ÿè£…**
  - è¦ä»¶ãƒ»ä»•æ§˜ã‚’ `nestify/CLAUDE.md` / Issue / ã‚³ãƒ¡ãƒ³ãƒˆã‹ã‚‰å†ç¢ºèªã—ãŸã‹ã€‚
  - å¤‰æ›´ãŒã©ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆUI / çŠ¶æ…‹ç®¡ç† / API / DBï¼‰ã«å½±éŸ¿ã™ã‚‹ã‹ã‚’æ•´ç†ã—ãŸã‹ã€‚
  - å¿…è¦ã«å¿œã˜ã¦ `nestify/ARCHITECTURE.md` ã‚’èª­ã¿ã€æ—¢å­˜ã®æ–¹é‡ã¨çŸ›ç›¾ã—ã¦ã„ãªã„ã‹ç¢ºèªã—ãŸã‹ã€‚
  - ã‚¿ã‚¹ã‚¯ã‚’è¦‹ç©ã‚‚ã‚Šã€`.claude/tasks.md` ã«è¿½åŠ ã—ãŸã‹ã€‚

- **During å®Ÿè£…**
  - æ–°è¦ã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦å‹æ³¨é‡ˆãƒ» strict ãƒ¢ãƒ¼ãƒ‰ã§ã®ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã£ã¦ã„ã‚‹ã‹ã€‚
  - ä¾‹å¤–ã§ã¯ãªã `Result` å‹ãªã©ã®å€¤ãƒ™ãƒ¼ã‚¹ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¾ã‚’ä½¿ãˆã¦ã„ã‚‹ã‹ã€‚
  - é–¢æ•°ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è²¬å‹™ãŒå¢—ãˆã™ãã¦ã„ãªã„ã‹ï¼ˆSRP ã‚’ç¶­æŒã—ã¦ã„ã‚‹ã‹ï¼‰ã€‚

- **After å®Ÿè£…**
  - å‹ãƒã‚§ãƒƒã‚¯ãƒ»lintï¼ˆåˆ©ç”¨å¯èƒ½ãªç¯„å›²ï¼‰ã‚’å®Ÿè¡Œã—ã€ã‚¨ãƒ©ãƒ¼ã‚’è§£æ¶ˆã—ãŸã‹ã€‚
  - æ—¢å­˜ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã‹ã€‚
  - å¿…è¦ãªãƒ†ã‚¹ãƒˆï¼ˆãƒ¦ãƒ‹ãƒƒãƒˆ / çµåˆ / E2Eï¼‰ã‚’è¿½åŠ ãƒ»æ›´æ–°ã—ãŸã‹ã€‚
  - ä»•æ§˜ãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«å½±éŸ¿ã™ã‚‹å¤‰æ›´ã®å ´åˆã€`nestify/ARCHITECTURE.md` ãªã©é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°ã—ãŸã‹ã€‚
  - `.claude/tasks.md` ã®è©²å½“ã‚¿ã‚¹ã‚¯ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦å®Œäº†ã‚’æ˜ç¤ºã—ãŸã‹ã€‚
  - é©åˆ‡ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ·»ãˆã¦ã‚³ãƒŸãƒƒãƒˆã—ãŸã‹ã€‚

- **Codex ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾å¿œ**
  - Stop ãƒ•ãƒƒã‚¯çµŒç”±ã§ Codex ãŒ `.claude/plan.md` ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã‚’è¿½è¨˜ã™ã‚‹ã€‚
  - ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†ã‚’ç¢ºèªã—ãŸã‚‰ `.claude/plan.md` ã®å†…å®¹ã‚’èª­ã¿è¾¼ã¿ã€æŒ‡æ‘˜ã«å¾“ã£ã¦ä¿®æ­£ã‚’è¡Œã†ã€‚
  - ä¿®æ­£å®Œäº†å¾Œã€`.claude/tasks.md` ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾å¿œã‚¿ã‚¹ã‚¯ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã€ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã€‚

---

## 6. skills & ãƒ„ãƒ¼ãƒ«åˆ©ç”¨æ–¹é‡

Claude Code ãŒã©ã®æƒ…å ±æºãƒ»ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ»ãƒ„ãƒ¼ãƒ«ã‚’ã„ã¤ä½¿ã†ã‹ã‚’ã“ã“ã«ã¾ã¨ã‚ã‚‹ã€‚

### 6.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½¿ã„æ–¹

- **`nestify/CLAUDE.md`ï¼ˆæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰**
  - Nestify ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹è¡Œå‹•ä»•æ§˜ãƒ»å“è³ªåŸºæº–ãƒ»å‚ç…§å…ˆã®å…¥å£ã€‚
- **`nestify/ARCHITECTURE.md`**
  - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ãŒçµ¡ã‚€å¤‰æ›´å‰ã«ã¯å¿…ãšèª­ã‚€ã€‚
  - æ–°ã—ã„ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼ˆã‚µãƒ¼ãƒ“ã‚¹ãƒ»ã‚¹ãƒˆã‚¢ãƒ»ãƒ«ãƒ¼ãƒˆï¼‰ã‚’è¿½åŠ ã™ã‚‹ã¨ãã‚‚ç¢ºèªã™ã‚‹ã€‚
- **`research-*` ç³»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
  - èª¿æŸ»ã‚¿ã‚¹ã‚¯ã‚„åˆ†æãƒ¬ãƒãƒ¼ãƒˆä½œæˆæ™‚ã«å‚ç…§ã™ã‚‹ã€‚
  - æ–°ã—ã„ research ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹éš›ã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å¾“ã†ã€‚

### 6.2 Cursor / Claude å´ã‚¹ã‚­ãƒ«ã®ä½¿ã„åˆ†ã‘

- **Explore ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  - ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹å…¨ä½“ã®æ¢ç´¢ã‚„ã€ã©ã“ã«ä½•ãŒã‚ã‚‹ã‹åˆ†ã‹ã‚‰ãªã„ã¨ãã«ä½¿ã†ã€‚
  - ä¾‹: ã€Œãƒ„ãƒªãƒ¼è¡¨ç¤ºã®ãƒ­ã‚¸ãƒƒã‚¯ãŒã©ã“ã«ã‚ã‚‹ã‹åˆ†ã‹ã‚‰ãªã„ã€ãªã©ã€‚
- **Plan ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**
  - è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ãŸãŒã‚‹éè‡ªæ˜ãªå¤‰æ›´ï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ã€æ©Ÿèƒ½è¿½åŠ ï¼‰ã®å‰ã«ã€è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ãŸã‚ã«ä½¿ã†ã€‚
  - ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ˆã†ãª CLAUDE è¨­å®šã®å¤§ããªå¤‰æ›´ã‚‚å¯¾è±¡ã€‚
- **WebSearch**
  - Spotify API ä»•æ§˜ã‚„å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆHono, Drizzle, TanStack Query ãªã©ï¼‰ã®æœ€æ–°æƒ…å ±ãŒå¿…è¦ãªã¨ãã®ã¿ä½¿ç”¨ã™ã‚‹ã€‚
  - å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å„ªå…ˆã—ã€å‡ºå…¸ã‚’æ„è­˜ã—ã¦ã¾ã¨ã‚ã‚‹ã€‚

### 6.3 ã‚¹ã‚­ãƒ«åˆ©ç”¨ã®ç°¡æ˜“ãƒ•ãƒ­ãƒ¼

```mermaid
flowchart TD
  taskReceived[taskReceived] --> needResearch{èª¿æŸ»ãŒå¿…è¦ã‹?}
  needResearch -->|Yes| useResearchDocs[research-* ã‚’å‚ç…§ã—èª¿æŸ»]
  needResearch -->|No| needArch{è¨­è¨ˆã‚„æ§‹é€ ã«é–¢ä¿‚ã™ã‚‹ã‹?}
  needArch -->|Yes| readArch[ARCHITECTURE.md ã‚’èª­ã‚€]
  needArch -->|No| implement[å®Ÿè£…/ä¿®æ­£ã‚’è¡Œã†]
  readArch --> implement
  useResearchDocs --> implement
```

---

## 7. å®Ÿè£…å„ªå…ˆé †ä½ï¼ˆPhase è¦ç´„ï¼‰

è©³ç´°ãªã‚¿ã‚¹ã‚¯å†…å®¹ã¯ `nestify/ARCHITECTURE.md` ã‚’å‚ç…§ã—ã€ã“ã“ã§ã¯ãƒ•ã‚§ãƒ¼ã‚ºæ§‹æˆã®ã¿ã‚’æŠ¼ã•ãˆã‚‹ã€‚

- **Phase 1: åŸºç›¤ï¼ˆã¾ãšå‹•ã‹ã™ï¼‰**
  1. ãƒ¢ãƒãƒ¬ãƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆBun workspaces + Turborepoï¼‰
  2. `packages/shared` ã®å‹å®šç¾©
  3. Drizzle ã‚¹ã‚­ãƒ¼ãƒ + ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
  4. Hono: Spotify OAuth ãƒ•ãƒ­ãƒ¼
  5. Hono: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ CRUD API
  6. Next.js: Spotify ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
  7. Next.js: ãƒ„ãƒªãƒ¼ UIï¼ˆé™çš„ãƒ‡ãƒ¼ã‚¿ï¼‰

- **Phase 2: ã‚³ã‚¢æ©Ÿèƒ½** 8. ãƒ„ãƒªãƒ¼ã¨ API ã®æ¥ç¶šï¼ˆTanStack Queryï¼‰9. `GET /:id/tracks` å†å¸° CTE å®Ÿè£… 10. å†ç”Ÿæ©Ÿèƒ½ï¼ˆSpotify Web Playback SDKï¼‰11. ã‚·ãƒ£ãƒƒãƒ•ãƒ«å†ç”Ÿãƒ»ç›´æ¥ã®ã¿å†ç”Ÿã®åˆ‡ã‚Šæ›¿ãˆ

- **Phase 3: UX å¼·åŒ–** 12. ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼ˆ@dnd-kitï¼‰13. Spotify ã¸ã®æ›¸ãå‡ºã— 14. Spotify ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¤ãƒ³ãƒãƒ¼ãƒˆ 15. bun test ã§ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ 

---

## 8. å°†æ¥ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆæ¦‚è¦ï¼‰

- ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªï¼ˆReact Native / Expoï¼‰
- Cloudflare Workers ã¸ã®ç§»è¡Œï¼ˆHono ã¯ãã®ã¾ã¾ CF Workers ã§å‹•ä½œå¯èƒ½ï¼‰
- ã‚³ãƒ©ãƒœç·¨é›†ï¼ˆè¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ 1 ãƒ„ãƒªãƒ¼ã‚’å…±åŒç®¡ç†ï¼‰
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼ˆPWA + IndexedDBï¼‰

---

## 9. ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½ç½®ã¥ã‘

- æœ¬ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`nestify/CLAUDE.md` / `nestify/new-CLAUDE.md`ï¼‰ã¯ã€Nestify ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã‘ã‚‹ **Claude Code ã®å…¥å£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ** ã§ã‚ã‚‹ã€‚
- è©³ç´°å®Ÿè£…æƒ…å ±ã¯ã‚³ãƒ¼ãƒ‰ã¨ `nestify/ARCHITECTURE.md` ã«å§”è­²ã—ã¤ã¤ã€Claude ã®è¡Œå‹•ã«å¿…è¦ãªæƒ…å ±ãƒ»å“è³ªåŸºæº–ãƒ»å‚ç…§å…ˆã®ã¿ã‚’ã“ã“ã«é›†ç´„ã™ã‚‹ã€‚
- æ–°ã—ã„ãƒ«ãƒ¼ãƒ«ã‚„æ–¹é‡ã‚’è¿½åŠ ã™ã‚‹å ´åˆã‚‚ã€
  - ã€ŒClaude ã®æŒ¯ã‚‹èˆã„ã«ç›´æ¥å½±éŸ¿ã™ã‚‹ã‹ï¼Ÿã€
  - ã€Œåˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã§æ¸ˆã¾ã›ã‚‰ã‚Œãªã„ã‹ï¼Ÿã€
    ã‚’ç¢ºèªã—ãŸã†ãˆã§ã€éåº¦ãªå†—é•·åŒ–ã‚’é¿ã‘ã‚‹ã“ã¨ã€‚

# Nestify â€” Claude Code ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»•æ§˜æ›¸

## è¨€èª

- å¸¸ã«æ—¥æœ¬èªã§å¿œç­”ã™ã‚‹ã“ã¨ã€‚

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**Nestify** ã¯ã€Spotifyã®æ¥½æ›²ã‚’å¯¾è±¡ã¨ã—ãŸã€Œãƒã‚¹ãƒˆå‹ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ã‚¢ãƒ—ãƒªã€ã§ã‚ã‚‹ã€‚
SpotifyãŒæä¾›ã™ã‚‹ãƒ•ãƒ©ãƒƒãƒˆãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ§‹é€ ã«å¯¾ã—ã¦ã€PCã®ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚ˆã†ã«**å†å¸°çš„ã«ç„¡é™ãƒã‚¹ãƒˆ**ã§ãã‚‹ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ä½“é¨“ã‚’æä¾›ã™ã‚‹ã€‚

### ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

- ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®ä¸­ã«ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å…¥ã‚Œã‚‰ã‚Œã‚‹ï¼ˆç„¡é™å†å¸°ï¼‰
- è¦ªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å†ç”Ÿã™ã‚‹ã¨ã€å­å­«ã®ã™ã¹ã¦ã®æ›²ã‚’å«ã‚ã¦ã‚·ãƒ£ãƒƒãƒ•ãƒ«å†ç”Ÿã§ãã‚‹
- è¦ªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ã€Œç›´æ¥è¿½åŠ ã®æ›²ã®ã¿ã€ã§å†ç”Ÿã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹
- éŸ³æºå†ç”Ÿã¯Spotifyã«å®Œå…¨ã«å§”ã­ã‚‹ã€‚ã‚¢ãƒ—ãƒªã¯ã‚ãã¾ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç®¡ç†ã«ç‰¹åŒ–ã™ã‚‹
- Spotifyã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³ã€æ—¢å­˜ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã€Spotifyã¸ã®æ›¸ãå‡ºã—ã«å¯¾å¿œ

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼ˆç¢ºå®šï¼‰

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

- **Next.js 15** (App Router)
- **React 19**
- **TypeScript**
- **Tailwind CSS v4**
- **Zustand** (ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆçŠ¶æ…‹ç®¡ç†)
- **TanStack Query v5** (ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹ãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥)
- **@dnd-kit** (ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—)

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

- **Bun** (ãƒ©ãƒ³ã‚¿ã‚¤ãƒ )
- **Hono** (Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯)
- **TypeScript**
- **Drizzle ORM**
- **PostgreSQL**
- **Hono RPC** (å‹å®‰å…¨ãªAPIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆ)

### ãƒ†ã‚¹ãƒˆ

- **bun test** (ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ)
- **Playwright** (E2Eãƒ†ã‚¹ãƒˆ)

### ãƒ¢ãƒãƒ¬ãƒç®¡ç†

- **Bun Workspaces**
- **Turborepo**

### ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆäºˆå®šï¼‰

- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: **Vercel**
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: **Railway** or **Fly.io**
- DB: **Supabase** (PostgreSQL)

---

## ãƒ¢ãƒãƒ¬ãƒæ§‹é€ 

```
nestify/
â”œâ”€â”€ package.json              # Bun workspaces ãƒ«ãƒ¼ãƒˆ
â”œâ”€â”€ turbo.json                # Turborepoè¨­å®š
â”œâ”€â”€ tsconfig.base.json        # å…±é€šTypeScriptè¨­å®š
â”‚
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ frontend/             # Next.js 15 + React 19
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ next.config.ts
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ â†’ /playlists
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ (auth)/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ callback/
â”‚   â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx  # Spotify OAuthã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ playlists/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ layout.tsx    # ã‚µã‚¤ãƒ‰ãƒãƒ¼ + NowPlaying
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ page.tsx  # ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè©³ç´°
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tree/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistTree.tsx      # ãƒ„ãƒªãƒ¼å…¨ä½“
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistTreeNode.tsx  # å†å¸°ãƒãƒ¼ãƒ‰
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ TreeContextMenu.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ playlist/
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlaylistHeader.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TrackList.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ TrackItem.tsx
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SubPlaylistGrid.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ player/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ NowPlayingBar.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ui/               # æ±ç”¨UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆshadcn/uiï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ playlistStore.ts  # Zustand: ãƒ„ãƒªãƒ¼çŠ¶æ…‹
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ playerStore.ts    # Zustand: å†ç”ŸçŠ¶æ…‹
â”‚   â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ usePlaylistTree.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ useSpotifyPlayer.ts
â”‚   â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚   â”‚       â”œâ”€â”€ api.ts            # Hono RPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆå‹è‡ªå‹•ç”Ÿæˆï¼‰
â”‚   â”‚   â”‚       â””â”€â”€ spotify.ts        # Spotify Web Playback SDK
â”‚   â”‚
â”‚   â”œâ”€â”€ backend/              # Hono on Bun
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts              # Honoã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆãƒ»ãƒ«ãƒ¼ãƒˆé›†ç´„
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts           # Spotify OAuth2 PKCE
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ playlists.ts      # ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆCRUD
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tracks.ts         # æ›²ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»ä¸¦ã³æ›¿ãˆ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ spotify.ts        # Spotify APIãƒ—ãƒ­ã‚­ã‚·
â”‚   â”‚   â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ schema.ts         # Drizzle ã‚¹ã‚­ãƒ¼ãƒå®šç¾©
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts          # DBæ¥ç¶š
â”‚   â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ playlistService.ts  # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå†å¸°å‡¦ç†ãªã©ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ spotifyService.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ auth.ts           # JWTæ¤œè¨¼
â”‚   â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚   â”‚       â”œâ”€â”€ playlists.test.ts
â”‚   â”‚   â”‚       â””â”€â”€ playlistService.test.ts
â”‚   â”‚
â”‚   â””â”€â”€ shared/               # ãƒ•ãƒ­ãƒ³ãƒˆãƒ»ãƒãƒƒã‚¯å…±é€šã®å‹å®šç¾©
â”‚       â”œâ”€â”€ package.json
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ types.ts
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« (packages/shared/src/types.ts)

```typescript
export interface Playlist {
  id: string;
  userId: string;
  name: string;
  icon: string; // emojiæ–‡å­—
  color: string; // CSSã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ–‡å­—åˆ—
  parentId: string | null; // null = ãƒ«ãƒ¼ãƒˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ
  order: number; // å…„å¼Ÿé–“ã®ä¸¦ã³é †
  createdAt: string;
  updatedAt: string;

  // APIãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚ã«ä»˜ä¸ã•ã‚Œã‚‹ä»®æƒ³ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  children?: Playlist[];
  tracks?: PlaylistTrack[];
  trackCount?: number; // å­å­«ã‚’å«ã‚€ç·æ›²æ•°ï¼ˆå†å¸°çš„ã«é›†è¨ˆï¼‰
}

export interface PlaylistTrack {
  id: string;
  playlistId: string;
  spotifyTrackId: string;
  order: number;
  addedAt: string;
  track?: SpotifyTrack; // Spotifyã‹ã‚‰å–å¾—ã—ãŸã‚­ãƒ£ãƒƒã‚·ãƒ¥
}

export interface SpotifyTrack {
  id: string;
  name: string;
  artists: string[];
  album: string;
  durationMs: number;
  previewUrl: string | null;
  imageUrl: string | null;
}

// APIãƒªã‚¯ã‚¨ã‚¹ãƒˆå‹
export interface CreatePlaylistDto {
  name: string;
  icon?: string;
  color?: string;
  parentId?: string | null;
}

export interface UpdatePlaylistDto {
  name?: string;
  icon?: string;
  color?: string;
  parentId?: string | null;
  order?: number;
}
```

---

## DBã‚¹ã‚­ãƒ¼ãƒ (Drizzle ORM)

```typescript
// packages/backend/src/db/schema.ts
import { pgTable, uuid, text, integer, timestamp } from "drizzle-orm/pg-core";

export const users = pgTable("users", {
  id: uuid("id").primaryKey().defaultRandom(),
  spotifyId: text("spotify_id").notNull().unique(),
  displayName: text("display_name").notNull(),
  email: text("email"),
  imageUrl: text("image_url"),
  accessToken: text("access_token").notNull(),
  refreshToken: text("refresh_token").notNull(),
  tokenExpiresAt: timestamp("token_expires_at").notNull(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const playlists = pgTable("playlists", {
  id: uuid("id").primaryKey().defaultRandom(),
  userId: uuid("user_id")
    .notNull()
    .references(() => users.id),
  parentId: uuid("parent_id").references((): any => playlists.id, {
    onDelete: "cascade",
  }),
  name: text("name").notNull(),
  icon: text("icon").notNull().default("ğŸµ"),
  color: text("color")
    .notNull()
    .default("linear-gradient(135deg,#7c6af7,#f76a8a)"),
  order: integer("order").notNull().default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const playlistTracks = pgTable("playlist_tracks", {
  id: uuid("id").primaryKey().defaultRandom(),
  playlistId: uuid("playlist_id")
    .notNull()
    .references(() => playlists.id, { onDelete: "cascade" }),
  spotifyTrackId: text("spotify_track_id").notNull(),
  order: integer("order").notNull().default(0),
  addedAt: timestamp("added_at").defaultNow(),
});
```

### å†å¸°CTEï¼ˆå­å­«ã®å…¨æ›²ã‚’åé›†ï¼‰

```sql
-- /:id/tracks ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ä½¿ç”¨
-- ã‚µãƒ–ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å«ã‚€å…¨æ›²ã‚’ãƒ•ãƒ©ãƒƒãƒˆã«å–å¾—ã™ã‚‹

WITH RECURSIVE descendants AS (
  SELECT id FROM playlists WHERE id = $1
  UNION ALL
  SELECT p.id FROM playlists p
  INNER JOIN descendants d ON p.parent_id = d.id
)
SELECT
  pt.*,
  p.name AS source_playlist_name
FROM playlist_tracks pt
JOIN playlists p ON p.id = pt.playlist_id
WHERE pt.playlist_id IN (SELECT id FROM descendants)
ORDER BY pt.order;
```

---

## Honoãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ (src/index.ts)

```typescript
import { Hono } from "hono";
import { cors } from "hono/cors";
import { logger } from "hono/logger";
import { authRoutes } from "./routes/auth";
import { playlistRoutes } from "./routes/playlists";
import { spotifyRoutes } from "./routes/spotify";
import { authMiddleware } from "./middleware/auth";

const app = new Hono();

app.use("*", logger());
app.use("*", cors({ origin: process.env.FRONTEND_URL! }));

app.route("/auth", authRoutes);

// ä»¥ä¸‹ã¯èªè¨¼å¿…é ˆ
app.use("/api/*", authMiddleware);
app.route("/api/playlists", playlistRoutes);
app.route("/api/spotify", spotifyRoutes);

// Hono RPCã®ãŸã‚å‹ã‚’exportï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒä½¿ã†ï¼‰
export type AppType = typeof app;

export default {
  port: process.env.PORT || 3000,
  fetch: app.fetch,
};
```

### ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ«ãƒ¼ãƒˆ (src/routes/playlists.ts)

```typescript
const app = new Hono();

app.get("/", getPlaylists); // ãƒ„ãƒªãƒ¼å…¨ä½“å–å¾—
app.get("/:id", getPlaylist); // å˜ä¸€ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ
app.get("/:id/tracks", getTracksRecursive); // å­å­«å«ã‚€å…¨æ›²ï¼ˆã‚·ãƒ£ãƒƒãƒ•ãƒ«å†ç”Ÿç”¨ï¼‰
app.post("/", zValidator("json", createSchema), createPlaylist);
app.patch("/:id", zValidator("json", updateSchema), updatePlaylist);
app.delete("/:id", deletePlaylist);
app.post("/:id/tracks", addTrack);
app.delete("/:id/tracks/:tid", removeTrack);
app.patch("/:id/tracks/reorder", reorderTracks);
app.post("/:id/export-to-spotify", exportToSpotify); // ãƒ•ãƒ©ãƒƒãƒˆå±•é–‹ã—ã¦Spotifyã«æ›¸ãå‡ºã—
```

---

## Spotify OAuth2 ãƒ•ãƒ­ãƒ¼ (PKCE)

```
1. GET /auth/login
   â†’ code_verifier + code_challenge ã‚’ã‚µãƒ¼ãƒãƒ¼å´ã§ç”Ÿæˆ
   â†’ Spotifyèªè¨¼URLã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

2. GET /auth/callback?code=xxx
   â†’ codeã‚’Spotifyã«é€ã‚Šaccess_token + refresh_tokenã‚’å–å¾—
   â†’ DBã«ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãƒ»ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
   â†’ JWTã‚’ç”Ÿæˆã—ã¦ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯JWTã‚’localStorageã«ä¿å­˜
   â†’ ä»¥é™ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«Authorization: Bearer {jwt}ã‚’ä»˜ä¸

4. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯Spotify APIã®ãƒ—ãƒ­ã‚­ã‚·å½¹ã¨ã—ã¦å‹•ä½œ
   â†’ ãƒˆãƒ¼ã‚¯ãƒ³æœŸé™åˆ‡ã‚Œæ™‚ã¯è‡ªå‹•ã§refreshã™ã‚‹
```

### å¿…è¦ãªSpotify APIã‚¹ã‚³ãƒ¼ãƒ—

```
playlist-read-private
playlist-read-collaborative
playlist-modify-public
playlist-modify-private
streaming
user-read-playback-state
user-modify-playback-state
user-read-currently-playing
```

---

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çŠ¶æ…‹ç®¡ç†

### Zustand: playlistStore

```typescript
interface PlaylistStore {
  playlists: Playlist[]; // ãƒ„ãƒªãƒ¼æ§‹é€ ï¼ˆãƒ«ãƒ¼ãƒˆã®ã¿ã€childrenã§ãƒã‚¹ãƒˆï¼‰
  selectedId: string | null;
  expandedIds: Set<string>;

  select: (id: string) => void;
  toggleExpand: (id: string) => void;
  setPlaylists: (playlists: Playlist[]) => void;
  movePlaylist: (id: string, newParentId: string | null) => Promise<void>;
}
```

### Zustand: playerStore

```typescript
interface PlayerStore {
  currentTrack: SpotifyTrack | null;
  queue: SpotifyTrack[];
  isPlaying: boolean;
  shuffle: boolean;
  sourcePlaylistId: string | null; // ã©ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‹ã‚‰å†ç”Ÿä¸­ã‹

  playPlaylist: (
    playlistId: string,
    options: { includeChildren: boolean; shuffle: boolean },
  ) => Promise<void>;
  playTrack: (track: SpotifyTrack) => void;
  next: () => void;
  prev: () => void;
  toggleShuffle: () => void;
}
```

### Hono RPCã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (lib/api.ts)

```typescript
import { hc } from "hono/client";
import type { AppType } from "@nestify/backend";

export const api = hc<AppType>(process.env.NEXT_PUBLIC_API_URL!);
```

---

## é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```bash
# åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
bun install

# å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä¸¦åˆ—èµ·å‹•ï¼ˆTurborepoï¼‰
bun dev

# å€‹åˆ¥èµ·å‹•
bun --filter frontend dev   # â†’ http://localhost:3000 (Next.js)
bun --filter backend dev    # â†’ http://localhost:3001 (Hono on Bun)

# ãƒ†ã‚¹ãƒˆ
bun test                    # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆï¼ˆbun test ãƒ“ãƒ«ãƒˆã‚¤ãƒ³ï¼‰
bun --filter backend test

# DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
bun --filter backend db:generate
bun --filter backend db:migrate

# ãƒ“ãƒ«ãƒ‰
bun run build
```

---

## ç’°å¢ƒå¤‰æ•°

### packages/backend/.env

```
DATABASE_URL=postgresql://localhost:5432/nestify
SPOTIFY_CLIENT_ID=your_client_id
SPOTIFY_CLIENT_SECRET=your_client_secret
SPOTIFY_REDIRECT_URI=http://localhost:3001/auth/callback
JWT_SECRET=your_jwt_secret
FRONTEND_URL=http://localhost:3000
PORT=3001
```

### packages/frontend/.env.local

```
NEXT_PUBLIC_API_URL=http://localhost:3001
NEXT_PUBLIC_SPOTIFY_CLIENT_ID=your_client_id
```

---

## UIæ–¹é‡

- **shadcn/ui ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€Tailwind CSS v4 ã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’çµ„ã‚€ã€‚**
- shadcn/ui: https://ui.shadcn.com/
- ã‚¢ã‚¤ã‚³ãƒ³: **lucide-react** ã‚’ä½¿ç”¨ã™ã‚‹ã€‚
- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç”¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆHeader, Sidebar ãªã©ï¼‰ã¯ã‚¢ãƒ—ãƒªå›ºæœ‰ã®ãŸã‚ `src/components/layout/` ã«é…ç½®ã™ã‚‹ã€‚
- shadcn/ui ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ `src/components/ui/` ã«é…ç½®ã™ã‚‹ï¼ˆ`npx shadcn add` ã§è¿½åŠ ï¼‰ã€‚

### Nestify ã®ãƒ‡ã‚¶ã‚¤ãƒ³æ–¹é‡

- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒå›ºå®šã€‚
- ãƒ•ã‚©ãƒ³ãƒˆ: Syneï¼ˆè¦‹å‡ºã—ï¼‰+ Space Monoï¼ˆæ•°å€¤ãƒ»ã‚³ãƒ¼ãƒ‰ï¼‰ã€‚
- ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼: #7c6af7ï¼ˆãƒ‘ãƒ¼ãƒ—ãƒ«ï¼‰/ #f76a8aï¼ˆãƒ”ãƒ³ã‚¯ï¼‰/ #6af7c8ï¼ˆã‚°ãƒªãƒ¼ãƒ³ï¼‰ã€‚
- å‚è€ƒUIãƒ¢ãƒƒã‚¯: `nestify-ui.html`ï¼ˆã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨åŒæ¢±ï¼‰ã€‚
- å†ç”Ÿä¸­ã®æ›²ã¯ã‚¢ã‚¯ã‚»ãƒ³ãƒˆã‚«ãƒ©ãƒ¼ã§ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹ã€‚
- ç¶™æ‰¿ã•ã‚ŒãŸæ›²ï¼ˆå­å­«ã‹ã‚‰æ¥ãŸæ›²ï¼‰ã¯ `ç¶™æ‰¿ Â· {ã‚½ãƒ¼ã‚¹PLå}` ãƒãƒƒã‚¸ã§è¦–è¦šçš„ã«åŒºåˆ¥ã™ã‚‹ã€‚

---

## é–‹ç™ºãƒ«ãƒ¼ãƒ«

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°: Railway Oriented Programming (ROP)

- APIãƒ»ã‚µãƒ¼ãƒ“ã‚¹å±¤ã§ã¯ **Railway Oriented Programming** ã«å¾“ã†ã€‚
- æˆåŠŸ/å¤±æ•—ã‚’ `Result` å‹ï¼ˆã¾ãŸã¯ `{ ok: true; data } | { ok: false; error }` ã®ã‚ˆã†ãªåˆ¤åˆ¥å¯èƒ½ãªå½¢ï¼‰ã§è¡¨ç¾ã—ã€ã‚¨ãƒ©ãƒ¼ã‚’å€¤ã¨ã—ã¦æ‰±ã†ã€‚
- ä¾‹å¤–ã¯äºˆæœŸã—ãªã„è‡´å‘½çš„ãªå ´åˆã«é™ã‚Šä½¿ç”¨ã™ã‚‹ã€‚ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å¤±æ•—ã¯æˆ»ã‚Šå€¤ã§è¿”ã™ã€‚

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’æ„è­˜ã™ã‚‹

- çŠ¶æ…‹å¤‰æ›´ã¯é¿ã‘ã€**ç´”ç²‹é–¢æ•°ãƒ»ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ãªæ›´æ–°**ã‚’å„ªå…ˆã™ã‚‹ã€‚
- å‰¯ä½œç”¨ï¼ˆAPIå‘¼ã³å‡ºã—ã€localStorageã€DOMï¼‰ã¯ hooks ã‚„æ˜ç¢ºãªå±¤ã«é›†ç´„ã™ã‚‹ã€‚
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å¯èƒ½ãªé™ã‚Š**å‚ç…§é€é**ã«ã—ã€åŒã˜ props ãªã‚‰åŒã˜è¦‹ãŸç›®ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

### ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

#### Server Component First

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ Server Component ã§å®Ÿè£…ã™ã‚‹ã€‚
- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®çŠ¶æ…‹ã‚„ã‚¤ãƒ™ãƒ³ãƒˆãŒå¿…è¦ãªå ´åˆã®ã¿ `"use client"` ã‚’ä»˜ä¸ã™ã‚‹ã€‚
- `"use client"` ã®ã‚¹ã‚³ãƒ¼ãƒ—ã¯å¿…è¦æœ€å°é™ã«ã™ã‚‹ã€‚

#### const-only

- åŸå‰‡ã¨ã—ã¦ `let` / `var` ã¯ä½¿ã‚ãš `const` ã®ã¿ã¨ã™ã‚‹ã€‚
- å†ä»£å…¥ãŒå¿…è¦ãªå ´åˆã¯è¨­è¨ˆã‚’è¦‹ç›´ã™ï¼ˆmap / filter / reduce ãªã©ã®åˆ©ç”¨ã‚’æ¤œè¨ã™ã‚‹ï¼‰ã€‚

#### TDDï¼ˆt-wada ã‚¹ã‚¿ã‚¤ãƒ«ï¼‰

- **Red â†’ Green â†’ Refactor** ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’å®ˆã‚‹ã€‚
- ãƒ†ã‚¹ãƒˆã‚’å…ˆã«æ›¸ãã€å¤±æ•—ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å®Ÿè£…ã™ã‚‹ã€‚
- ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯ã€Œä»•æ§˜ãŒèª­ã‚ã‚‹ã€ã‚ˆã†ã«æ›¸ãã€‚

#### SRP / DRY

- å˜ä¸€è²¬ä»»ã®åŸå‰‡ï¼ˆSRPï¼‰: 1ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ»1é–¢æ•°ï¼1ã¤ã®è²¬å‹™ã€‚
- DRY: é‡è¤‡ã‚³ãƒ¼ãƒ‰ã‚’è¨±å®¹ã—ãªã„ã€‚ä¾‹å¤–ã‚’è¨­ã‘ã‚‹å ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆã§ç†ç”±ã‚’æ®‹ã™ã€‚

#### TypeScript

- `any` ã¯ç¦æ­¢ã€‚å¿…è¦ãªå ´åˆã¯ `unknown` ã¨å‹ã‚¬ãƒ¼ãƒ‰ã‚’ä½¿ã†ã€‚
- å‹æ¨è«–ã«é ¼ã‚Šã™ããšã€é–¢æ•°ã®å¼•æ•°ã¨æˆ»ã‚Šå€¤ã®å‹ã¯æ˜ç¤ºã™ã‚‹ã€‚
- `strict: true` ã‚’ç¶­æŒã™ã‚‹ã€‚

#### å‘½åè¦å‰‡

| å¯¾è±¡                       | è¦å‰‡             | ä¾‹                           |
| -------------------------- | ---------------- | ---------------------------- |
| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ             | PascalCase       | `PlaylistCard`               |
| é–¢æ•°ãƒ»å¤‰æ•°                 | camelCase        | `fetchPlaylists`             |
| å®šæ•°                       | UPPER_SNAKE_CASE | `MAX_RETRY_COUNT`            |
| å‹ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹       | PascalCase       | `Playlist`, `IPlaylistProps` |
| ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰ | PascalCase.tsx   | `Header.tsx`                 |
| ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãã®ä»–ï¼‰         | camelCase.ts     | `utils.ts`                   |

#### Import ã®é †åº

```typescript
// 1. React / Next.js
import { useState } from "react";
import { useRouter } from "next/navigation";

// 2. å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
import { create } from "zustand";

// 3. å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾ãƒ‘ã‚¹ï¼‰
import { Button } from "@/components/ui/button";

// 4. ç›¸å¯¾ãƒ‘ã‚¹
import { useLocalStorage } from "./hooks";

// 5. å‹ã®ã¿
import type { Playlist } from "@/types";
```

### ã‚¿ã‚¹ã‚¯ç®¡ç†ãƒ»ã‚³ãƒŸãƒƒãƒˆ

- **ä½œæ¥­é–‹å§‹å‰**: ã‚¿ã‚¹ã‚¯ã‚’è¦‹ç©ã‚‚ã‚Šã€`.claude/tasks.md` ã«ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å½¢å¼ã§è¿½åŠ ã™ã‚‹ã€‚
- **ä½œæ¥­å®Œäº†æ™‚**: `.claude/tasks.md` ã®è©²å½“ã‚¿ã‚¹ã‚¯ã«ãƒã‚§ãƒƒã‚¯ï¼ˆ`[x]`ï¼‰ã‚’å…¥ã‚Œã¦å®Œäº†ã‚’æ˜ç¤ºã™ã‚‹ã€‚
- **ã‚¿ã‚¹ã‚¯å®Œäº†å¾Œ**: é©åˆ‡ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ·»ãˆã¦ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã€‚

### Codex ãƒ¬ãƒ“ãƒ¥ãƒ¼é€£æº

- Claude Code ãŒå®Ÿè£…ã‚’å®Œäº†ã™ã‚‹ã¨ã€Stop ãƒ•ãƒƒã‚¯çµŒç”±ã§ Codexï¼ˆGitHub Copilot CLIï¼‰ãŒè‡ªå‹•çš„ã«ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡Œã„ã€çµæœã‚’ `.claude/plan.md` ã«è¿½è¨˜ã™ã‚‹ã€‚
- **Codex ãŒãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Œäº†ã—ãŸå ´åˆ**: `.claude/plan.md` ã®å†…å®¹ã‚’èª­ã¿è¾¼ã¿ã€æŒ‡æ‘˜äº‹é …ãƒ»ææ¡ˆã«å¾“ã£ã¦ä¿®æ­£ã‚’è¡Œã†ã€‚
- **ä¿®æ­£ãŒå®Œäº†ã—ãŸã‚‰**: `.claude/tasks.md` ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼å¯¾å¿œã‚¿ã‚¹ã‚¯ã«ãƒã‚§ãƒƒã‚¯ï¼ˆ`[x]`ï¼‰ã‚’å…¥ã‚Œã€é©åˆ‡ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ·»ãˆã¦ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã€‚

### æŒ¯ã‚‹èˆã„

- ä¸æ˜ç‚¹ã¯ä»®å®šã›ãšè³ªå•ã™ã‚‹ã€‚
- ä»®å®šã‚„æ¨æ¸¬ã§é€²ã‚ã‚‹å ´åˆã¯ã€ãã®æ—¨ã‚’æ˜ç¤ºã™ã‚‹ã€‚

### ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

- ç°¡æ½”ã‹ã¤ç«¯çš„ã«æ›¸ãã€‚
- æŠ€è¡“çš„ãªåˆ¤æ–­ç†ç”±ãŒå¿…è¦ãªã¨ãã¯èª¬æ˜ã™ã‚‹ã€‚

### ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

- å¿…è¦ã«å¿œã˜ã¦ **Agents team** ã‚’ä½¿ç”¨ã—ã¦ã‚ˆã„ã€‚
- è‡ªå‹•é¸æŠã‚’å„ªå…ˆã—ã¤ã¤ã€ä»¥ä¸‹ã‚’ç›®å®‰ã«ã™ã‚‹ã€‚
  - **Explore**: ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ¢ç´¢ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢ãƒ»æ—¢å­˜å®Ÿè£…ã®èª¿æŸ»ã€‚
  - **Plan**: éè‡ªæ˜ãªå¤‰æ›´ã‚„è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ãŸãŒã‚‹å®Ÿè£…ã®å‰ã«è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ã€‚
  - å˜ç´”ãªè³ªå•ã‚„å°ã•ãªç·¨é›†ã§ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä¹±ç™ºã—ãªã„ã€‚
  - ä½¿ç”¨ã—ãŸå ´åˆã¯ã€çµæœã‚„æ–¹é‡ã‚’ç°¡æ½”ã«ã¾ã¨ã‚ã¦ã‹ã‚‰æ¬¡ã«é€²ã‚€ã€‚

### å“è³ªåŸºæº–

- å“è³ªåŸºæº–ï¼ˆãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ»ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆãªã©ï¼‰ã¯åˆ¥é€”ç²¾æŸ»ã™ã‚‹ã€‚ç¾æ™‚ç‚¹ã§ã¯ä¸Šè¨˜ã®é–‹ç™ºãƒ«ãƒ¼ãƒ«ã«å¾“ã†ã€‚

---

## å®Ÿè£…å„ªå…ˆé †ä½

### Phase 1: åŸºç›¤ï¼ˆã¾ãšå‹•ã‹ã™ï¼‰

1. ãƒ¢ãƒãƒ¬ãƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆBun workspaces + Turborepoï¼‰
2. `packages/shared` ã®å‹å®šç¾©
3. Drizzle ã‚¹ã‚­ãƒ¼ãƒ + ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
4. Hono: Spotify OAuth ãƒ•ãƒ­ãƒ¼
5. Hono: ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆCRUD API
6. Next.js: Spotifyãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
7. Next.js: ãƒ„ãƒªãƒ¼UIï¼ˆé™çš„ãƒ‡ãƒ¼ã‚¿ã§ï¼‰

### Phase 2: ã‚³ã‚¢æ©Ÿèƒ½

8. ãƒ„ãƒªãƒ¼ã¨APIã®æ¥ç¶šï¼ˆTanStack Queryï¼‰
9. `GET /:id/tracks` å†å¸°CTEå®Ÿè£…
10. å†ç”Ÿæ©Ÿèƒ½ï¼ˆSpotify Web Playback SDKï¼‰
11. ã‚·ãƒ£ãƒƒãƒ•ãƒ«å†ç”Ÿãƒ»ç›´æ¥ã®ã¿å†ç”Ÿã®åˆ‡ã‚Šæ›¿ãˆ

### Phase 3: UXå¼·åŒ–

12. ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼ˆ@dnd-kitï¼‰
13. Spotifyã¸ã®æ›¸ãå‡ºã—
14. Spotifyãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¤ãƒ³ãƒãƒ¼ãƒˆ
15. bun testã§ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ 

---

## å°†æ¥ã®ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

- ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªï¼ˆReact Native / Expoï¼‰
- Cloudflare Workersã¸ã®ç§»è¡Œï¼ˆHonoã¯ãã®ã¾ã¾CF Workersã§å‹•ãï¼‰
- ã‚³ãƒ©ãƒœç·¨é›†ï¼ˆè¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§1ãƒ„ãƒªãƒ¼ã‚’å…±åŒç®¡ç†ï¼‰
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œï¼ˆPWA + IndexedDBï¼‰

---

## å‚ç…§ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ«                               | ç”¨é€”                                 |
| -------------------------------------- | ------------------------------------ |
| æœ¬ãƒ•ã‚¡ã‚¤ãƒ« (CLAUDE.md / new-CLAUDE.md) | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®šã¨é–‹ç™ºãƒ«ãƒ¼ãƒ«         |
| ARCHITECTURE.md                        | ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦ãƒ»ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€  |
| nestify-ui.html                        | UIãƒ¢ãƒƒã‚¯ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³å‚è€ƒ               |
| packages/shared/src/types.ts           | å…±é€šå‹å®šç¾©                           |
| packages/backend/src/db/schema.ts      | DBã‚¹ã‚­ãƒ¼ãƒ                           |
| packages/backend/src/index.ts          | APIãƒ«ãƒ¼ãƒˆé›†ç´„ãƒ»AppType export        |
